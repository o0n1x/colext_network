apiVersion: v1
kind: Pod
metadata:
  name: fl-server
  labels:
    fltb-dev-type: server
    fltb-job-id: {{ job_id }}
spec:
  containers:
  - name: fl-server
    image: {{ image }}
    command: ["python3", "{{ server_entrypoint }}"]
    args: {{ image_args }}
    env:
      - name: FLTB_ENV
        value: "1"
      - name: FLTB_JOB_ID
        value: "{{ job_id }}"
    ports:
      - containerPort: 8080
        name: fl-server-svc-port
    startupProbe:
      tcpSocket:
        port: fl-server-svc-port
      failureThreshold: 3
      periodSeconds: 100
  restartPolicy: Never
  imagePullSecrets:
  - name: regcred
  nodeSelector:
    kubernetes.io/hostname: kw61463
